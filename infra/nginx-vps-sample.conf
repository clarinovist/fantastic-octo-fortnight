# Ini file contoh konfigurasi Nginx untuk VPS.
# Simpan di VPS: /etc/nginx/sites-available/lesprivate
# Lalu simlink: ln -s /etc/nginx/sites-available/lesprivate /etc/nginx/sites-enabled/
# Dan install SSL: certbot --nginx

# 1. Homepage (Landing Page)
server {
    server_name lesprivate.my.id www.lesprivate.my.id;

    location / {
        proxy_pass http://localhost:8081; # Port Homepage Updated (Conflicts with Host 80 if not changed)
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# 2. Frontend (Customer App)
server {
    server_name app.lesprivate.my.id;

    location / {
        proxy_pass http://localhost:3001; # Port Frontend
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# 3. Mentor Portal
server {
    server_name mentor.lesprivate.my.id;

    location / {
        proxy_pass http://localhost:3002; # Port Mentor
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# 4. Admin Dashboard
server {
    server_name admin.lesprivate.my.id;

    location / {
        proxy_pass http://localhost:3000; # Port Admin
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# 5. Backend API
server {
    server_name api.lesprivate.my.id;

    location / {
        proxy_pass http://localhost:8080; # Port Backend
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
